<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/weblayout}"
      xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <title>Quản lý nhân viên - PolyWatch</title>
</head>

<body>
<div layout:fragment="content" class="container-fluid">
    <main id="main" class="main">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-lg-2 h-100" id="leftKH">
            <h1 class="heading-page">Người dùng</h1>
            <div class="card" id="formLeft">
                <h3 class="leftTitle" style="margin-top: 10px">Chức vụ</h3>
                <div class="boxLeftC">
                    <select class="roleFilter w-100" multiple style="width: 100%" onchange="onRoleChange(this)">
                        <option value="Quản trị viên">Quản trị viên</option>
                        <option value="Nhân viên">Nhân viên</option>
                        <option value="Kiểm kho">Kiểm kho</option>

                    </select>
                </div>
                <div style="border: 1px solid #e3e3e3;margin: 12px 12px;border-radius: 8px;">
                </div>
                <div style="">
                    <h3 class="leftTitle">Trạng thái</h3>
                    <div class="boxLeftC">
                        <div class="form-group form-check">
                            <input class="form-check-input" type="radio" name="status" id="statusAll" value="Tất cả" onchange="onStatusChange(this)" checked>
                            <label class="form-check-label" for="statusAll">
                                Tất cả
                            </label>
                        </div>
                        <div class="form-group form-check">
                            <input class="form-check-input" type="radio" name="status" id="statusActive" value="Đang hoạt động" onchange="onStatusChange(this)">
                            <label class="form-check-label" for="statusActive">
                                Đang hoạt động
                            </label>
                        </div>
                        <div class="form-group form-check">
                            <input class="form-check-input" type="radio" name="status" id="statusInactive" value="Ngừng hoạt động" onchange="onStatusChange(this)">
                            <label class="form-check-label" for="statusInactive">
                                Ngừng hoạt động
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End-Sidebar -->
        <div class="col-lg-10" id="rightKH">
            <div class="row justify-content-end">
                <button type="button" class="btn btn-primary col-auto mb-3 me-2 waves-effect waves-light" data-bs-toggle="modal" data-bs-target=".modal-add-staff">
                    <i class="fas fa-plus me-2"></i>Người dùng
                </button>
            </div>
            <div class="card">
                <div class="card-body overflow-auto">
                    <table id="datatable"
                           class="table table-striped table-hover table-bordered nowrap dataTable no-footer shadow"
                           style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                        <thead class="text-center">
                            <th></th>
                            <th>Chức năng</th>
                            <th>Ảnh đại diện</th>
                            <th class="header-name">Họ tên</th>
                            <th>Ngày sinh</th>
                            <th>Số điện thoại</th>
                            <th>Email</th>
                            <th>Địa chỉ</th>
                            <th>Chức vụ</th>
                            <th>Ngày bắt đầu</th>
                            <th>Trạng thái</th>
                        </thead>
                        <tbody style="vertical-align: middle;">
                        <tr th:each="staff, iterator : ${staffs}">
                            <td class="text-end info-index">
                                <!-- <span th:text="${iterator.index + 1}"></span>-->
                            </td>
                            <td th:switch="${staff.getStatus()}" class="text-center">
                                <i class="col-4 fas fa-edit" style="color: darkblue;" title="Cập nhật" onclick="onBtnEdit(this)"></i>
                                <i th:case="1" class="col-4 fas fa-lock-open" style="color: green;" title="Khoá tài khoản" onclick="onBtnStatus(this)"></i>
                                <i th:case="0" class="col-4 fas fa-lock" style="color: red;" title="Mở khoá tài khoản" onclick="onBtnStatus(this)"></i>
                                <i class="col-4 fas fa-user-times" style="color: red;" title="Xoá người dùng" onclick="onBtnDelete(this)"></i>
                            </td>
                            <td class="text-center">
                                <img th:src="${staff.getAvatar()}" alt="avatar" class="border rounded" height="50">
                            </td>

                                <input type="hidden" class="check-item" th:value="${staff.getId()}">

                            <td th:text="${staff.getFullName()}">Họ tên</td>
                            <td th:text="${#dates.format(staff.getDateOfBirth(), 'dd/MM/yyyy')}" class="text-center">Ngày sinh</td>
                            <td th:text="${staff.getPhoneNumber()}">Số điện thoại</td>
                            <td th:text="${staff.getEmail()}">Email</td>
                            <td th:text="${staff.getAddress()}">Địa chỉ</td>
                            <td th:switch="${staff.getRole()}" class="text-center">
                                <span th:case="ROLE_ADMIN" class="role">Quản trị viên</span>
                                <span th:case="ROLE_USER" class="role">Nhân viên</span>
                                <span th:case="ROLE_STOCK" class="role">Kiểm kho</span>
                            </td>
                            <td th:text="${#dates.format(staff.getCreateDate(), 'dd/MM/yyyy HH:mm:ss')}" class="text-center">Ngày bắt đầu</td>
                            <td th:switch="${staff.getStatus()}" class="text-center">
                                <span th:case="1" class="status badge bg-success fs-6">Đang hoạt động</span>
                                <span th:case="0" class="status badge bg-danger fs-6">Ngừng hoạt động</span>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Add Staff -->
    <div class="modal fade modal-add-staff" tabindex="-1" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title mt-0">Thêm người dùng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="formAdd">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-2 px-4 my-auto waves-effect waves-light" onclick="$('#img-file').click()" style="cursor: pointer">
                                <img src="" class="rounded border" id="img-temp" alt="avatar" width="160">
                            </div>
                            <div class="col-5 px-4">
                                <table class="table-borderless w-100">
                                    <tr>
                                        <th style="width: 140px"><label class="form-label" for="fullName">Họ và tên</label><span class="required"> *</span></th>
                                        <td><input class="form-control" type="text" name="fullName" id="fullName" onblur="onType(this)"></td>
                                    </tr>
                                    <tr>
                                        <th style="width: 140px;"><label for="email" class="form-label">Email</label><span class="required"> *</span></th>
                                        <td><input type="email" name="email" id="email" class="form-control" onblur="onType(this)" placeholder="abc@email.com"></td>
                                    </tr>
                                    <tr>
                                        <th><label for="role" class="form-label">Chức vụ</label><span class="required"> *</span></th>
                                        <td>
                                            <select class="form-select" name="role" id="role" onchange="onType(this)">
                                                <option value="" disabled selected>-- Chọn Chức vụ --</option>
                                                <option value="ROLE_ADMIN">Quản trị viên</option>
                                                <option value="ROLE_USER">Nhân viên</option>
                                                <option value="ROLE_STOCK">Kiểm kho</option>

                                            </select>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-5 px-4">
                                <table class="table-borderless w-100">

                                    <tr>
                                        <th><label for="phoneNumber" class="form-label">Điện thoại</label><span class="required"> *</span></th>
                                        <td><input type="number" name="phoneNumber" id="phoneNumber" class="form-control" onblur="onType(this)" placeholder="0323456789"></td>
                                    </tr>
                                    <tr>
                                        <th><label for="address" class="form-label">Địa chỉ</label><span class="required"> *</span></th>
                                        <td><input type="text" name="address" id="address" class="form-control" onblur="onType(this)"></td>
                                    </tr>
                                    <tr>
                                        <th><label for="birthdate" class="form-label">Ngày sinh</label><span class="required"> *</span></th>
                                        <td>
                                            <div class="input-daterange input-group" id="datepicker-dateOfBirth" data-date-format="dd/mm/yyyy" data-date-autoclose="true" data-provide="datepicker" data-date-container='#datepicker-dateOfBirth'>
                                                <input type="text" name="dateOfBirth" id="birthdate" class="form-control text-start" onblur="onType(this)" placeholder="dd/MM/yyyy">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th style="vertical-align: top; padding-top: 7px;"><label for="note" class="form-label">Ghi chú</label></th>
                                        <td><textarea name="note" id="note" cols="30" rows="3" class="form-control"></textarea></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <input type="file" id="img-file" accept="image/*" style="display: none;" onchange="onChangeAvatar('add')"/>
                    <input type="hidden" id="img-base64" name="avatar"/>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="resetForm()">
                        <i class="fas fa-ban me-2"></i>Đóng
                    </button>
                    <button type="button" class="btn btn-success" onclick="resetForm()">
                        <i class="fa fa-trash me-2"></i>Làm mới
                    </button>
                    <button type="button" id="btnAdd" class="btn btn-primary waves-effect waves-light">
                        <i class="fas fa-save pe-2"></i>Lưu
                    </button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- End Modal Add Staff -->

    <!-- Modal Edit Staff -->
    <div class="modal fade modal-edit-staff" tabindex="-1" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title mt-0">Cập nhật người dùng</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="formEdit">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-2 px-4 my-auto waves-effect waves-light" onclick="$('#img-file-edit').click()" style="cursor: pointer">
                                <img src="" class="rounded border" id="img-temp-edit" alt="avatar" width="160">
                            </div>
                            <div class="col-5 px-4">
                                <table class="table-borderless w-100">
                                    <tr>
                                        <th><label class="form-label" for="fullName-edit">Họ và tên</label><span class="required"> *</span></th>
                                        <td><input class="form-control" type="text" name="fullName" id="fullName-edit" onblur="onType(this)"></td>
                                    </tr>
                                    <tr>
                                        <th><label for="email-edit" class="form-label">Email</label><span class="required"> *</span></th>
                                        <td><input type="email" name="email" id="email-edit" class="form-control" title="Không thể sửa email" disabled></td>
                                    </tr>
                                    <tr>
                                        <th><label for="role-edit" class="form-label">Chức vụ</label><span class="required"> *</span></th>
                                        <td>
                                            <select class="form-select" name="role" id="role-edit">
                                                <option value="" disabled selected>-- Chọn Chức vụ --</option>
                                                <option value="ROLE_ADMIN">Quản trị viên</option>
                                                <option value="ROLE_USER">Nhân viên</option>
                                                <option value="ROLE_STOCK">Kiểm kho</option>

                                            </select>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-5 px-4">
                                <table class="table-borderless w-100">
                                    <tr>
                                        <th><label for="phoneNumber-edit" class="form-label">Điện thoại</label><span class="required"> *</span></th>
                                        <td><input type="number" name="phoneNumber" id="phoneNumber-edit" class="form-control" onblur="onType(this)" placeholder="0323456789"></td>
                                    </tr>
                                    <tr>
                                        <th><label for="address-edit" class="form-label">Địa chỉ</label><span class="required"> *</span></th>
                                        <td><input type="text" name="address" id="address-edit" class="form-control" onblur="onType(this)"></td>
                                    </tr>
                                    <tr>
                                        <th><label for="birthdate-edit" class="form-label">Ngày sinh</label><span class="required"> *</span></th>
                                        <td>
                                            <div class="input-daterange input-group" id="datepicker6" data-date-format="dd/mm/yyyy" data-date-autoclose="true" data-provide="datepicker" data-date-container='#datepicker6'>
                                                <input type="text" name="dateOfBirth" id="birthdate-edit" class="form-control text-start" onblur="onType(this)" placeholder="dd/MM/yyyy">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <th style="vertical-align: top; padding-top: 7px;"><label for="note-edit" class="form-label">Ghi chú</label></th>
                                        <td><textarea name="note" id="note-edit" cols="30" rows="3" class="form-control"></textarea></td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" name="id" id="id">
                    <input type="file" id="img-file-edit" accept="image/*" style="display: none;" onchange="onChangeAvatar('edit')"/>
                    <input type="hidden" id="img-base64-edit" name="avatar"/>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="resetForm()">
                        <i class="fas fa-ban me-2"></i>
                        Đóng
                    </button>
                    <button type="button" class="btn btn-success" onclick="resetForm()">
                        <i class="fa fa-trash me-2"></i>
                        Làm mới
                    </button>
                    <button type="button" id="btnEdit" class="btn btn-primary waves-effect waves-light">
                        <i class="fas fa-save pe-2"></i>
                        Lưu
                    </button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
    <!-- End Modal Edit Staff -->
    </main>
</div>

<script layout:fragment="script" >
    // Init const variable
    const base64Image = "data:@file/png;base64,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";

    $(document).ready(function () {
        $('.roleFilter').chosen();

        hoverIconLock();

        // Add default image to Modal add staff
        $('#img-temp').attr('src', base64Image);
    });

    // resize datatable and remark index row table
    function resizeTable() {
        $('th.header-name:first').click();
        $('th.header-name:first').click();
        $('th.header-name:first').click();

        $('#datatable tbody tr:not(:hidden) .info-index').each(function (index) {
            $(this).text(index + 1);
        });
    }

    function hoverIconLock() {
        $('.fa-lock-open').hover(function () {
            $(this).removeClass('fa-lock-open').addClass('fa-lock').css('color', 'red');
        }, function () {
            $(this).removeClass('fa-lock').addClass('fa-lock-open').css('color', 'green');
        })

        $('.fa-lock').hover(function () {
            $(this).removeClass('fa-lock').addClass('fa-lock-open').css('color', 'green');
        }, function () {
            $(this).removeClass('fa-lock-open').addClass('fa-lock').css('color', 'red');
        })
    }

    $('.arrow').click(function (e) {
        $(this).toggleClass('down');
        $(this).siblings('.expand').toggle();
    })

    $('.check-item').change(function (e) {
        const flag = checkSiblings();

        if (flag) {
            $('#checkAll').prop('checked', true);
        } else {
            $('#checkAll').prop('checked', false);
        }

        function checkSiblings() {
            const checkboxes = $('.check-item').parent().find('input[type="checkbox"]');
            let checkFlag = true;

            checkboxes.each(function () {
                if ($(this).prop("checked") === false) {
                    checkFlag = false;
                }
            });
            return checkFlag;
        }
    });

    // disable mousewheel on a input number field when in focus
    // (to prevent Chromium browsers change the value when scrolling)
    $('form').on('focus', 'input[type=number]', function (e) {
        $(this).on('wheel.disableScroll', function (e) {
            e.preventDefault()
        })
    })
    $('form').on('blur', 'input[type=number]', function (e) {
        $(this).off('wheel.disableScroll')
    })

    // event filter table by status
    function onStatusChange(element) {
        const status = $(element).val();
        const rows = $('table#datatable tr');

        if(status === 'Tất cả') {
            rows.show();
        } else {
            rows.hide();
            rows.find(`.status:contains(${status})`).parent().parent().show();
        }
        resizeTable();
    }

    // event filter table by role
    function onRoleChange() {
        const role = $('select.roleFilter').val();
        const rows = $('table#datatable tr');

        if (role.length === 0) {
            rows.show();
        } else {
            rows.hide();
            role.forEach(e => {
                rows.find(`.role:contains(${e})`).parent().parent().show();
            })
        }
        resizeTable();
    }

    // event reset form
    function resetForm() {
        // Reset form input
        const formInput = $("form :input");
        formInput.val("");
        $('#role').prop('selectedIndex', 0);
        formInput.removeClass('error');

        // Reset input file
        $('#img-temp').attr('src', base64Image);
    }

    // Submit formAdd
    $('#btnAdd').click(function () {
        let data = {};
        let formData = $('#formAdd').serializeArray();
        console.log(formData);
        $.each(formData, function (i, v) {
            data["" + v.name + ""] = v.value;
            console.log(v.name);
            console.log(v.value);
        });
        console.log(data);
        data["dateOfBirth"] = moment(data["dateOfBirth"], 'DD-MM-YYYY').format('YYYY-MM-DD');
        data["username"] = generateUsername(convertViToEn(data["fullName"])) + moment(data["dateOfBirth"], 'YYYY-MM-DD').format('DDMM');

        if(validateForm('add')) {
            addStaff(data);
        } else {
            console.log("validate fail");
        }
    });

    // Event onKeyPress formAdd
    function onType(element) {
        const tag = $(element);
        if(tag.val() === '') {
            tag.addClass('error');
        } else {
            tag.removeClass('error');
        }
    }

    // Event onBlur for input date
    $('#birthdate').blur(function () {
        setTimeout(function(){
            onType($('#birthdate'));
        }, 100); // delay 500 ms
    });

    // Event onBlur for input date
    $('#birthdate-edit').blur(function () {
        setTimeout(function(){
            onType($('#birthdate-edit'));
        }, 100); // delay 500 ms
    });

    // Validation formAdd
    function validateForm(type) {
        let errorMessage = '';
        const fullName = (type === 'add') ? $('#fullName') : $('#fullName-edit');
        let flag = true;

        if (fullName.val() === '') {
            fullName.addClass('error');
            flag = false;
        }

        if (type === 'add') {
            const email =  $('#email');
            const patternEmail = /^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i;
            if (email.val() === '') {
                email.addClass('error');
                flag = false;
            } else if (!patternEmail.test(email.val())) {
                email.addClass('error');
                errorMessage += 'Email không hợp lệ!\n';
                flag = false;
            } else {
                $.ajax({
                    url: `/api/staff/find/email/${email.val()}`,
                    async: false,
                    type: 'GET',
                    contentType: 'application/json',
                    dataType: 'json',
                    success: function (result) {
                        if (result !== 0) {
                            email.addClass('error');
                            errorMessage += 'Email đã được sử dụng!\n';
                            flag = false;
                            console.log(errorMessage);
                        }
                    },
                    error: function (error) {

                    }
                })
            }
        }

        const role = (type === 'add') ? $('#role') : $('#role-edit');
        if (role.val() === null) {
            role.addClass('error');
            flag = false;
        }

        const phoneNumber = (type === 'add') ? $('#phoneNumber') : $('#phoneNumber-edit');
        const patternPhone = /^(84|0[3|5|7|8|9])+([0-9]{8})\b$/i;
        if (phoneNumber.val() === '') {
            phoneNumber.addClass('error');
            flag = false;
        } else if (!patternPhone.test(phoneNumber.val())) {
            phoneNumber.addClass('error');
            errorMessage += 'Số điện thoại không hợp lệ!\n';
            flag = false;
        } else if (type === 'add') {
            $.ajax({
                url: `/api/staff/find/phone/${phoneNumber.val()}`,
                async: false,
                type: 'GET',
                contentType: 'application/json',
                dataType: 'json',
                success: function (result) {
                    if (result !== 0) {
                        phoneNumber.addClass('error');
                        errorMessage += 'Số điện thoại đã được sử dụng!\n';
                        flag = false;
                    }
                },
                error: function (error) {

                }
            })
        }

        const address = (type === 'add') ? $('#address') : $('#address-edit');
        if (address.val() === '') {
            address.addClass('error');
            flag = false;
        }



        if (type === 'edit') {
            const username = $('#staffCode-edit')
            if (username.val() === '') {
                username.addClass('error');
                flag = false;
            }
        }

        if (type === 'edit') {
            const username = $('#username')
            if (username.val() === '') {
                username.addClass('error');
                flag = false;
            }
        }

        if (flag) {
            return true
        }
        errorMessage += 'Mời nhập lại!'
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
        })
        Toast.fire({
            icon: 'error',
            title: errorMessage
        })
        return false;
    }

    //API add Staff
    function addStaff(data) {
        $.ajax({
            url: '/api/staff',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(data),
            dataType: 'json',
            success: function (result) {
                $('.modal-add-staff').modal('hide');
                Swal.fire({
                    position: 'center',
                    icon: 'success',
                    title: 'Thêm thành công',
                    showConfirmButton: true,
                    timerProgressBar: true,
                    timer: 2000
                }).then(()=> window.location.reload());
            },
            error: function (error) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'error',
                    title: 'Lỗi khi thêm mới'
                })
            }
        })
    }

    // Submit formEdit
    $('#btnEdit').click(function () {
        let data = {};
        let formData = $('#formEdit').serializeArray();
        $.each(formData, function (i, v) {
            data["" + v.name + ""] = v.value;
        });
        data["dateOfBirth"] = moment(data["dateOfBirth"], 'DD-MM-YYYY').format('YYYY-MM-DD');

        if(validateForm('edit')) {
            editStaff(data);
        } else {
            console.log("validate fail");
        }
    });

    //API edit Staff
    function editStaff(data) {
        $.ajax({
            url: '/api/staff',
            type: 'PUT',
            contentType: 'application/json',
            data: JSON.stringify(data),
            dataType: 'json',
            success: function (result) {
                $('.modal-edit-staff').modal('hide');
                Swal.fire({
                    position: 'center',
                    icon: 'success',
                    title: 'Cập nhật thành công',
                    showConfirmButton: true,
                    timerProgressBar: true,
                    timer: 2000
                }).then(()=> window.location.reload());
            },
            error: function (error) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'error',
                    title: "Lỗi hệ thống!\nVui lòng thử lại sau"
                })
            }
        })
    }

    function onBtnEdit (element) {
        const tag = $(element).parent().parent().find('.check-item');
        $.ajax({
            url: `/api/staff/${tag.val()}`,
            type: 'GET',
            contentType: 'application/json',
            success: function (result) {
                // Input image
                $('#img-temp-edit').attr('src', result.avatar);
                $('#img-base64-edit').val(result.avatar);

                $('#id').val(result.id);
                $('#fullName-edit').val(result.fullName);
                $('#email-edit').val(result.email);
                $('#role-edit').val(result.role);
                $('#phoneNumber-edit').val(result.phoneNumber);
                $('#address-edit').val(result.address);
                $('#birthdate-edit').val(moment(result.dateOfBirth).format('DD/MM/YYYY'));
                $('#note-edit').val(result.note);

                $('.modal-edit-staff').modal('show');
            },
            error: function (error) {
                console.log(error);
            }
        })
    }

    function onBtnStatus (element) {
        const tag = $(element).parent().parent();
        const lock = $(element).hasClass('fa-lock');
        const status = lock ? "0" : "1";
        const length_of_row = $('table#datatable th').length;
        $.ajax({
            url: `/api/staff/status/${tag.find('.check-item').val()}/${status}`,
            type: 'PUT',
            contentType: 'application/json',
            success: function (result) {
                Swal.fire(
                    lock ? 'Đã khoá tài khoản!' : 'Đã mở khoá tài khoản',
                    `Mã nhân viên ${tag.find('.staff-code').text()}`,
                    'success'
                ).then(() => {
                    if (lock) {
                        $(element).removeClass('fa-lock-open').addClass('fa-lock').css('color', 'red');
                        tag.find('.status').text("Ngừng hoạt động");
                        tag.find('.status').removeClass('badge bg-success');
                        tag.find('.status').addClass('badge bg-danger');
                    } else {
                        $(element).removeClass('fa-lock').addClass('fa-lock-open').css('color', 'green');
                        tag.find('.status').text("Đang hoạt động");
                        tag.find('.status').removeClass('badge bg-danger');
                        tag.find('.status').addClass('badge bg-success');
                    }

                    hoverIconLock();
                })
            },
            error: function (error) {
                console.log(error);
                Swal.fire(
                    'Lỗi hệ thống!\nVui lòng thử lại sau!',
                    'error'
                )
            }
        })
    }

    function onBtnDelete (element) {
        const tag = $(element).parent().parent();
        const swalWithBootstrapButtons = Swal.mixin({
            customClass: {
                confirmButton: 'btn btn-success mx-2',
                cancelButton: 'btn btn-danger mx-2'
            },
            buttonsStyling: false
        })

        swalWithBootstrapButtons.fire({
            title: `Bạn chắc chắn muốn xoá <br> Nhân viên mã có ${tag.find('.staff-code').text()} chứ?`,
            text: "Chú ý không thể hoàn tác sau khi thực hiện tác vụ này!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: 'Vâng, tôi chắc chắn!',
            cancelButtonText: 'Không, huỷ bỏ tác vụ!',
            reverseButtons: true
        }).then((result) => {
            if (result.isConfirmed) {
                swalWithBootstrapButtons.fire(
                    'Đã xoá thành công!',
                    'Dữ liệu đã bị xoá.',
                    'success'
                ).then(
                    $.ajax({
                        url: `/api/staff/delete/${tag.find('.check-item').val()}`,
                        type: 'PUT',
                        contentType: 'application/json',
                        success: function (result) {
                            window.location.href = "/staff";
                        },
                        error: function (error) {
                            console.log(error);
                        }
                    })
                );
            } else if (
                result.dismiss === Swal.DismissReason.cancel
            ) {
                swalWithBootstrapButtons.fire(
                    'Đã huỷ tác vụ',
                    'Dữ liệu được bảo toàn :)',
                    'error'
                )
            }
        })
    }

    // JavaScript: Chuyển tiếng Việt có dấu sang không dấu
    function convertViToEn(str, toUpperCase = false) {
        str = str.toLowerCase();
        str = str.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g, "a");
        str = str.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g, "e");
        str = str.replace(/ì|í|ị|ỉ|ĩ/g, "i");
        str = str.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g, "o");
        str = str.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g, "u");
        str = str.replace(/ỳ|ý|ỵ|ỷ|ỹ/g, "y");
        str = str.replace(/đ/g, "d");
        // Some system encode vietnamese combining accent as individual utf-8 characters
        str = str.replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g, ""); // Huyền sắc hỏi ngã nặng
        str = str.replace(/\u02C6|\u0306|\u031B/g, ""); // Â, Ê, Ă, Ơ, Ư

        return toUpperCase ? str.toUpperCase() : str;
    }

    /**
     * Generate Username from fullname
     */
    function generateUsername(str) {
        //Split to array of words
        let arr = str.split(' ');
        let username = arr[arr.length - 1];

        // Remove firstname from array of fullname
        arr.pop();

        // Get the First Letter of each String
        arr.forEach(e => username+=e.charAt(0));
        if (arr.length === 1) {
            return arr[0];
        }
        return username;
    }

    // On change Avatar
    function onChangeAvatar(type) {
        const allowedFiles = ["jpeg", "png"];
        const file = $(`#img-file${type === 'edit' ? '-edit' : ''}`).prop('files')[0];
        if (file) {
            let found = false;
            allowedFiles.forEach(function (extension) {
                if (file.type.match('image/' + extension)) {
                    found = true;
                }
            });
            if (found) {
                // Preview image
                $(`#img-temp${type === 'edit' ? '-edit' : ''}`).attr('src', URL.createObjectURL(file));

                // Adding value to input form
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onloadend = function() {
                    $(`#img-base64${type === 'edit' ? '-edit' : ''}`).val(reader.result);
                }
            } else {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                });
                Toast.fire({
                    icon: 'error',
                    title: 'Ảnh không hợp lệ!'
                });
            }
        }
    }
</script>

</body>
</html>